<!--
  Created by Cursor

  This is a custom slider block layout for the slider block.
  It is used to display the slider content.
  It is based on the default slider block layout, but with some customizations.
  It is used to display the slider content.
-->
{{ $block := .block }}
{{ $page := .page }}

{{ $slides := $block.content.slides }}
{{ $design := $block.design }}

<div class="slider-block">
  <div id="slider-{{ $page.File.UniqueID }}" class="carousel slide" data-bs-ride="carousel" data-bs-interval="{{ $design.interval | default 5000 }}">
    
    <!-- Carousel indicators -->
    {{ if gt (len $slides) 1 }}
      <div class="carousel-indicators">
        {{ range $index, $slide := $slides }}
          <button type="button" data-bs-target="#slider-{{ $page.File.UniqueID }}" data-bs-slide-to="{{ $index }}" 
                  class="{{ if eq $index 0 }}active{{ end }}" aria-current="{{ if eq $index 0 }}true{{ else }}false{{ end }}" 
                  aria-label="Slide {{ add $index 1 }}"></button>
        {{ end }}
      </div>
    {{ end }}
    
    <!-- Carousel items -->
    <div class="carousel-inner">
      {{ range $index, $slide := $slides }}
        <div class="carousel-item {{ if eq $index 0 }}active{{ end }}">
          {{ if $slide.background.image }}
            <div class="carousel-background" style="
              background-image: url('{{ $slide.background.image.filename | default $slide.background.image }}');
              background-position: {{ $slide.background.position | default 'center' }};
              background-size: cover;
              background-color: {{ $slide.background.color | default '#666' }};
              height: {{ $design.slide_height | default '400px' }};
              position: relative;
            ">
              {{ if $slide.background.image.filters }}
                <div class="background-overlay" style="
                  position: absolute;
                  top: 0;
                  left: 0;
                  right: 0;
                  bottom: 0;
                  background-color: rgba(0,0,0,{{ sub 1 (div (float $slide.background.image.filters.brightness) 1) }});
                "></div>
              {{ end }}
              
              <div class="carousel-content d-flex align-items-center justify-content-center" style="
                position: relative;
                z-index: 2;
                height: 100%;
                text-align: {{ $slide.align | default 'center' }};
                color: white;
                padding: 2rem;
              ">
                <div>
                  {{ if $slide.title }}
                    <h2 class="mb-3">{{ $slide.title }}</h2>
                  {{ end }}
                  
                  {{ if $slide.content }}
                    <p class="lead mb-4">{{ $slide.content }}</p>
                  {{ end }}
                  
                  {{ if $slide.link }}
                    <a href="{{ $slide.link.url }}" class="btn btn-light btn-lg">
                      {{ if $slide.link.icon }}
                        <i class="fas fa-{{ $slide.link.icon }} me-2"></i>
                      {{ end }}
                      {{ $slide.link.text }}
                    </a>
                  {{ end }}
                </div>
              </div>
            </div>
          {{ else }}
            <!-- Fallback for slides without background images -->
            <div class="carousel-content d-flex align-items-center justify-content-center" style="
              height: {{ $design.slide_height | default '400px' }};
              background-color: {{ $slide.background.color | default '#666' }};
              text-align: {{ $slide.align | default 'center' }};
              color: white;
              padding: 2rem;
            ">
              <div>
                {{ if $slide.title }}
                  <h2 class="mb-3">{{ $slide.title }}</h2>
                {{ end }}
                
                {{ if $slide.content }}
                  <p class="lead mb-4">{{ $slide.content }}</p>
                {{ end }}
                
                {{ if $slide.link }}
                  <a href="{{ $slide.link.url }}" class="btn btn-light btn-lg">
                    {{ if $slide.link.icon }}
                      <i class="fas fa-{{ $slide.link.icon }} me-2"></i>
                    {{ end }}
                    {{ $slide.link.text }}
                  </a>
                {{ end }}
              </div>
            </div>
          {{ end }}
        </div>
      {{ end }}
    </div>
    
    <!-- Carousel controls -->
    {{ if gt (len $slides) 1 }}
      <button class="carousel-control-prev" type="button" data-bs-target="#slider-{{ $page.File.UniqueID }}" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#slider-{{ $page.File.UniqueID }}" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    {{ end }}
  </div>
</div>

<style>
.slider-block {
  margin: 2rem 0;
}

.carousel-background {
  background-attachment: fixed;
}

@media (max-width: 768px) {
  .carousel-background {
    background-attachment: scroll;
  }
}
</style> 